add support for:
* pipes between threads
* API 